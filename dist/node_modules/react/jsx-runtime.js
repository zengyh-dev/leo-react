const supportSymbol = typeof Symbol === 'function' && Symbol.for;
// Symbol.for(key) 方法会根据给定的键 key，来从运行时的 symbol 注册表中找到对应的 symbol
// 如果找到了，则返回它
// 否则，新建一个与该键关联的 symbol，并放入全局 symbol 注册表中。
const REACT_ELEMENT_TYPE = supportSymbol
    ? Symbol.for('react.element')
    : 0xeac7;

const ReactElement = (type, key, ref, props) => {
    // 定义一个react element
    const element = {
        $$typeof: REACT_ELEMENT_TYPE,
        type,
        key,
        ref,
        props,
        __mark: 'leo' // 用于区分真实的react
    };
    return element;
};
const jsx = (type, config, ...maybeChildren) => {
    let key = null;
    let ref = null;
    const props = {};
    for (const prop in config) {
        const val = config[prop];
        if (prop === 'key') {
            // 特殊处理key
            if (val !== undefined) {
                key = String(val);
            }
            continue;
        }
        if (prop === 'ref') {
            // 特殊处理ref
            if (val !== undefined) {
                ref = String(val);
            }
            continue;
        }
        if (Object.prototype.hasOwnProperty.call(config, prop)) {
            // 只复制私有的，不复制原型上的
            props[prop] = val;
        }
    }
    const maybeChildrenLength = maybeChildren.length;
    if (maybeChildrenLength) {
        // [child]  |  [child, child, child]
        if (maybeChildren === 1) {
            // 一个reactElement
            props.children = maybeChildren[0];
        }
        else {
            // reactElement数组
            props.children = maybeChildren;
        }
    }
    return ReactElement(type, key, ref, props);
};
const jsxDEV = (type, config) => {
    let key = null;
    let ref = null;
    const props = {};
    for (const prop in config) {
        const val = config[prop];
        if (prop === 'key') {
            // 特殊处理key
            if (val !== undefined) {
                key = String(val);
            }
            continue;
        }
        if (prop === 'ref') {
            // 特殊处理ref
            if (val !== undefined) {
                ref = String(val);
            }
            continue;
        }
        if (Object.prototype.hasOwnProperty.call(config, prop)) {
            // 只复制私有的，不复制原型上的
            props[prop] = val;
        }
    }
    return ReactElement(type, key, ref, props);
};

export { jsx, jsxDEV };
